[[36m2022-09-10 10:37:14,219[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Enforcing tags! <cfg.extras.enforce_tags=True>[0m
[[36m2022-09-10 10:37:14,236[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Printing config tree with Rich! <cfg.extras.print_config=True>[0m
[[36m2022-09-10 10:37:14,237[0m][[34msrc.utils.rich_utils[0m][[33mWARNING[0m] - Field 'logger' not found in config. Skipping 'logger' config printing...[0m
CONFIG
â”œâ”€â”€ datamodule
â”‚   â””â”€â”€ _target_: src.datamodules.cifar10_datamodule.CIFAR10DataModule          
â”‚       data_dir: /code/data/                                                   
â”‚       batch_size: 64                                                          
â”‚       train_val_test_split:                                                   
â”‚       - 45000                                                                 
â”‚       - 5000                                                                  
â”‚       - 10000                                                                 
â”‚       num_workers: 12                                                         
â”‚       pin_memory: false                                                       
â”‚                                                                               
â”œâ”€â”€ model
â”‚   â””â”€â”€ _target_: src.models.cifar10_module.CIFAR10LitModule                    
â”‚       optimizer:                                                              
â”‚         _target_: torch.optim.Adam                                            
â”‚         _partial_: true                                                       
â”‚         lr: 0.002                                                             
â”‚         weight_decay: 0.0                                                     
â”‚       model: resnet18                                                         
â”‚                                                                               
â”œâ”€â”€ callbacks
â”‚   â””â”€â”€ model_checkpoint:                                                       
â”‚         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
â”‚         dirpath: checkpoints                                                  
â”‚         filename: epoch_{epoch:03d}                                           
â”‚         monitor: val/acc                                                      
â”‚         verbose: false                                                        
â”‚         save_last: true                                                       
â”‚         save_top_k: 1                                                         
â”‚         mode: max                                                             
â”‚         auto_insert_metric_name: false                                        
â”‚         save_weights_only: false                                              
â”‚         every_n_train_steps: null                                             
â”‚         train_time_interval: null                                             
â”‚         every_n_epochs: null                                                  
â”‚         save_on_train_epoch_end: null                                         
â”‚       early_stopping:                                                         
â”‚         _target_: pytorch_lightning.callbacks.EarlyStopping                   
â”‚         monitor: val/acc                                                      
â”‚         min_delta: 0.0                                                        
â”‚         patience: 100                                                         
â”‚         verbose: false                                                        
â”‚         mode: max                                                             
â”‚         strict: true                                                          
â”‚         check_finite: true                                                    
â”‚         stopping_threshold: null                                              
â”‚         divergence_threshold: null                                            
â”‚         check_on_train_epoch_end: null                                        
â”‚       model_summary:                                                          
â”‚         _target_: pytorch_lightning.callbacks.RichModelSummary                
â”‚         max_depth: -1                                                         
â”‚       rich_progress_bar:                                                      
â”‚         _target_: pytorch_lightning.callbacks.RichProgressBar                 
â”‚                                                                               
â”œâ”€â”€ trainer
â”‚   â””â”€â”€ _target_: pytorch_lightning.Trainer                                     
â”‚       default_root_dir: /code/logs/train/runs/2022-09-10_10-37-13             
â”‚       min_epochs: 1                                                           
â”‚       max_epochs: 1                                                           
â”‚       accelerator: cpu                                                        
â”‚       devices: 1                                                              
â”‚       deterministic: false                                                    
â”‚       gradient_clip_val: 0.5                                                  
â”‚                                                                               
â”œâ”€â”€ paths
â”‚   â””â”€â”€ root_dir: /code                                                         
â”‚       data_dir: /code/data/                                                   
â”‚       log_dir: /code/logs/                                                    
â”‚       output_dir: /code/logs/train/runs/2022-09-10_10-37-13                   
â”‚       work_dir: /code                                                         
â”‚                                                                               
â”œâ”€â”€ extras
â”‚   â””â”€â”€ ignore_warnings: false                                                  
â”‚       enforce_tags: true                                                      
â”‚       print_config: true                                                      
â”‚                                                                               
â”œâ”€â”€ task_name
â”‚   â””â”€â”€ train                                                                   
â”œâ”€â”€ tags
â”‚   â””â”€â”€ ['dev']                                                                 
â”œâ”€â”€ train
â”‚   â””â”€â”€ True                                                                    
â”œâ”€â”€ test
â”‚   â””â”€â”€ True                                                                    
â”œâ”€â”€ ckpt_path
â”‚   â””â”€â”€ None                                                                    
â””â”€â”€ seed
    â””â”€â”€ 12345                                                                   
[[36m2022-09-10 10:37:14,507[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating datamodule <src.datamodules.cifar10_datamodule.CIFAR10DataModule>[0m
[[36m2022-09-10 10:37:14,545[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating model <src.models.cifar10_module.CIFAR10LitModule>[0m
[[36m2022-09-10 10:37:15,986[0m][[34mtimm.models.helpers[0m][[32mINFO[0m] - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)[0m
[[36m2022-09-10 10:37:23,260[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating callbacks...[0m
[[36m2022-09-10 10:37:23,262[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>[0m
[[36m2022-09-10 10:37:23,270[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>[0m
[[36m2022-09-10 10:37:23,277[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>[0m
[[36m2022-09-10 10:37:23,281[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>[0m
[[36m2022-09-10 10:37:23,282[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating loggers...[0m
[[36m2022-09-10 10:37:23,284[0m][[34msrc.utils.utils[0m][[33mWARNING[0m] - Logger config is empty.[0m
[[36m2022-09-10 10:37:23,285[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating trainer <pytorch_lightning.Trainer>[0m
[[36m2022-09-10 10:37:23,626[0m][[34m__main__[0m][[32mINFO[0m] - Starting training![0m
Files already downloaded and verified
Files already downloaded and verified
â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ    â”ƒ Name                      â”ƒ Type                 â”ƒ Params â”ƒ
â”¡â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0  â”‚ net                       â”‚ ResNet               â”‚ 11.2 M â”‚
â”‚ 1  â”‚ net.conv1                 â”‚ Conv2d               â”‚  9.4 K â”‚
â”‚ 2  â”‚ net.bn1                   â”‚ BatchNorm2d          â”‚    128 â”‚
â”‚ 3  â”‚ net.act1                  â”‚ ReLU                 â”‚      0 â”‚
â”‚ 4  â”‚ net.maxpool               â”‚ MaxPool2d            â”‚      0 â”‚
â”‚ 5  â”‚ net.layer1                â”‚ Sequential           â”‚  147 K â”‚
â”‚ 6  â”‚ net.layer1.0              â”‚ BasicBlock           â”‚ 74.0 K â”‚
â”‚ 7  â”‚ net.layer1.0.conv1        â”‚ Conv2d               â”‚ 36.9 K â”‚
â”‚ 8  â”‚ net.layer1.0.bn1          â”‚ BatchNorm2d          â”‚    128 â”‚
â”‚ 9  â”‚ net.layer1.0.drop_block   â”‚ Identity             â”‚      0 â”‚
â”‚ 10 â”‚ net.layer1.0.act1         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 11 â”‚ net.layer1.0.aa           â”‚ Identity             â”‚      0 â”‚
â”‚ 12 â”‚ net.layer1.0.conv2        â”‚ Conv2d               â”‚ 36.9 K â”‚
â”‚ 13 â”‚ net.layer1.0.bn2          â”‚ BatchNorm2d          â”‚    128 â”‚
â”‚ 14 â”‚ net.layer1.0.act2         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 15 â”‚ net.layer1.1              â”‚ BasicBlock           â”‚ 74.0 K â”‚
â”‚ 16 â”‚ net.layer1.1.conv1        â”‚ Conv2d               â”‚ 36.9 K â”‚
â”‚ 17 â”‚ net.layer1.1.bn1          â”‚ BatchNorm2d          â”‚    128 â”‚
â”‚ 18 â”‚ net.layer1.1.drop_block   â”‚ Identity             â”‚      0 â”‚
â”‚ 19 â”‚ net.layer1.1.act1         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 20 â”‚ net.layer1.1.aa           â”‚ Identity             â”‚      0 â”‚
â”‚ 21 â”‚ net.layer1.1.conv2        â”‚ Conv2d               â”‚ 36.9 K â”‚
â”‚ 22 â”‚ net.layer1.1.bn2          â”‚ BatchNorm2d          â”‚    128 â”‚
â”‚ 23 â”‚ net.layer1.1.act2         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 24 â”‚ net.layer2                â”‚ Sequential           â”‚  525 K â”‚
â”‚ 25 â”‚ net.layer2.0              â”‚ BasicBlock           â”‚  230 K â”‚
â”‚ 26 â”‚ net.layer2.0.conv1        â”‚ Conv2d               â”‚ 73.7 K â”‚
â”‚ 27 â”‚ net.layer2.0.bn1          â”‚ BatchNorm2d          â”‚    256 â”‚
â”‚ 28 â”‚ net.layer2.0.drop_block   â”‚ Identity             â”‚      0 â”‚
â”‚ 29 â”‚ net.layer2.0.act1         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 30 â”‚ net.layer2.0.aa           â”‚ Identity             â”‚      0 â”‚
â”‚ 31 â”‚ net.layer2.0.conv2        â”‚ Conv2d               â”‚  147 K â”‚
â”‚ 32 â”‚ net.layer2.0.bn2          â”‚ BatchNorm2d          â”‚    256 â”‚
â”‚ 33 â”‚ net.layer2.0.act2         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 34 â”‚ net.layer2.0.downsample   â”‚ Sequential           â”‚  8.4 K â”‚
â”‚ 35 â”‚ net.layer2.0.downsample.0 â”‚ Conv2d               â”‚  8.2 K â”‚
â”‚ 36 â”‚ net.layer2.0.downsample.1 â”‚ BatchNorm2d          â”‚    256 â”‚
â”‚ 37 â”‚ net.layer2.1              â”‚ BasicBlock           â”‚  295 K â”‚
â”‚ 38 â”‚ net.layer2.1.conv1        â”‚ Conv2d               â”‚  147 K â”‚
â”‚ 39 â”‚ net.layer2.1.bn1          â”‚ BatchNorm2d          â”‚    256 â”‚
â”‚ 40 â”‚ net.layer2.1.drop_block   â”‚ Identity             â”‚      0 â”‚
â”‚ 41 â”‚ net.layer2.1.act1         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 42 â”‚ net.layer2.1.aa           â”‚ Identity             â”‚      0 â”‚
â”‚ 43 â”‚ net.layer2.1.conv2        â”‚ Conv2d               â”‚  147 K â”‚
â”‚ 44 â”‚ net.layer2.1.bn2          â”‚ BatchNorm2d          â”‚    256 â”‚
â”‚ 45 â”‚ net.layer2.1.act2         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 46 â”‚ net.layer3                â”‚ Sequential           â”‚  2.1 M â”‚
â”‚ 47 â”‚ net.layer3.0              â”‚ BasicBlock           â”‚  919 K â”‚
â”‚ 48 â”‚ net.layer3.0.conv1        â”‚ Conv2d               â”‚  294 K â”‚
â”‚ 49 â”‚ net.layer3.0.bn1          â”‚ BatchNorm2d          â”‚    512 â”‚
â”‚ 50 â”‚ net.layer3.0.drop_block   â”‚ Identity             â”‚      0 â”‚
â”‚ 51 â”‚ net.layer3.0.act1         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 52 â”‚ net.layer3.0.aa           â”‚ Identity             â”‚      0 â”‚
â”‚ 53 â”‚ net.layer3.0.conv2        â”‚ Conv2d               â”‚  589 K â”‚
â”‚ 54 â”‚ net.layer3.0.bn2          â”‚ BatchNorm2d          â”‚    512 â”‚
â”‚ 55 â”‚ net.layer3.0.act2         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 56 â”‚ net.layer3.0.downsample   â”‚ Sequential           â”‚ 33.3 K â”‚
â”‚ 57 â”‚ net.layer3.0.downsample.0 â”‚ Conv2d               â”‚ 32.8 K â”‚
â”‚ 58 â”‚ net.layer3.0.downsample.1 â”‚ BatchNorm2d          â”‚    512 â”‚
â”‚ 59 â”‚ net.layer3.1              â”‚ BasicBlock           â”‚  1.2 M â”‚
â”‚ 60 â”‚ net.layer3.1.conv1        â”‚ Conv2d               â”‚  589 K â”‚
â”‚ 61 â”‚ net.layer3.1.bn1          â”‚ BatchNorm2d          â”‚    512 â”‚
â”‚ 62 â”‚ net.layer3.1.drop_block   â”‚ Identity             â”‚      0 â”‚
â”‚ 63 â”‚ net.layer3.1.act1         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 64 â”‚ net.layer3.1.aa           â”‚ Identity             â”‚      0 â”‚
â”‚ 65 â”‚ net.layer3.1.conv2        â”‚ Conv2d               â”‚  589 K â”‚
â”‚ 66 â”‚ net.layer3.1.bn2          â”‚ BatchNorm2d          â”‚    512 â”‚
â”‚ 67 â”‚ net.layer3.1.act2         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 68 â”‚ net.layer4                â”‚ Sequential           â”‚  8.4 M â”‚
â”‚ 69 â”‚ net.layer4.0              â”‚ BasicBlock           â”‚  3.7 M â”‚
â”‚ 70 â”‚ net.layer4.0.conv1        â”‚ Conv2d               â”‚  1.2 M â”‚
â”‚ 71 â”‚ net.layer4.0.bn1          â”‚ BatchNorm2d          â”‚  1.0 K â”‚
â”‚ 72 â”‚ net.layer4.0.drop_block   â”‚ Identity             â”‚      0 â”‚
â”‚ 73 â”‚ net.layer4.0.act1         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 74 â”‚ net.layer4.0.aa           â”‚ Identity             â”‚      0 â”‚
â”‚ 75 â”‚ net.layer4.0.conv2        â”‚ Conv2d               â”‚  2.4 M â”‚
â”‚ 76 â”‚ net.layer4.0.bn2          â”‚ BatchNorm2d          â”‚  1.0 K â”‚
â”‚ 77 â”‚ net.layer4.0.act2         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 78 â”‚ net.layer4.0.downsample   â”‚ Sequential           â”‚  132 K â”‚
â”‚ 79 â”‚ net.layer4.0.downsample.0 â”‚ Conv2d               â”‚  131 K â”‚
â”‚ 80 â”‚ net.layer4.0.downsample.1 â”‚ BatchNorm2d          â”‚  1.0 K â”‚
â”‚ 81 â”‚ net.layer4.1              â”‚ BasicBlock           â”‚  4.7 M â”‚
â”‚ 82 â”‚ net.layer4.1.conv1        â”‚ Conv2d               â”‚  2.4 M â”‚
â”‚ 83 â”‚ net.layer4.1.bn1          â”‚ BatchNorm2d          â”‚  1.0 K â”‚
â”‚ 84 â”‚ net.layer4.1.drop_block   â”‚ Identity             â”‚      0 â”‚
â”‚ 85 â”‚ net.layer4.1.act1         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 86 â”‚ net.layer4.1.aa           â”‚ Identity             â”‚      0 â”‚
â”‚ 87 â”‚ net.layer4.1.conv2        â”‚ Conv2d               â”‚  2.4 M â”‚
â”‚ 88 â”‚ net.layer4.1.bn2          â”‚ BatchNorm2d          â”‚  1.0 K â”‚
â”‚ 89 â”‚ net.layer4.1.act2         â”‚ ReLU                 â”‚      0 â”‚
â”‚ 90 â”‚ net.global_pool           â”‚ SelectAdaptivePool2d â”‚      0 â”‚
â”‚ 91 â”‚ net.global_pool.flatten   â”‚ Flatten              â”‚      0 â”‚
â”‚ 92 â”‚ net.global_pool.pool      â”‚ AdaptiveAvgPool2d    â”‚      0 â”‚
â”‚ 93 â”‚ net.fc                    â”‚ Linear               â”‚  5.1 K â”‚
â”‚ 94 â”‚ criterion                 â”‚ CrossEntropyLoss     â”‚      0 â”‚
â”‚ 95 â”‚ train_acc                 â”‚ Accuracy             â”‚      0 â”‚
â”‚ 96 â”‚ val_acc                   â”‚ Accuracy             â”‚      0 â”‚
â”‚ 97 â”‚ test_acc                  â”‚ Accuracy             â”‚      0 â”‚
â”‚ 98 â”‚ val_acc_best              â”‚ MaxMetric            â”‚      0 â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 11.2 M                                                        
Non-trainable params: 0                                                         
Total params: 11.2 M                                                            
Total estimated model params size (MB): 44                                      
Epoch 0    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 783/783 0:16:22 â€¢ 0:00:00 4.03it/s loss: 0.957      
                                                               val/acc: 0.688   
                                                               val/acc_best:    
                                                               0.688 train/acc: 
                                                               0.589            
[[36m2022-09-10 10:53:57,466[0m][[34m__main__[0m][[32mINFO[0m] - Starting testing![0m
Files already downloaded and verified
Files already downloaded and verified
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ        Test metric        â”ƒ       DataLoader 0        â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚         test/acc          â”‚    0.6866000294685364     â”‚
â”‚         test/loss         â”‚    0.9233477711677551     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Testing â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 157/157 0:00:06 â€¢ 0:00:00 24.83it/s 
[[36m2022-09-10 10:54:05,195[0m][[34m__main__[0m][[32mINFO[0m] - Best ckpt path: /code/checkpoints/epoch_000-v1.ckpt[0m
[[36m2022-09-10 10:54:05,199[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Closing loggers...[0m
[[36m2022-09-10 10:54:05,200[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Output dir: /code/logs/train/runs/2022-09-10_10-37-13[0m
[[36m2022-09-10 10:54:05,201[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Metric name is None! Skipping metric value retrieval...[0m
